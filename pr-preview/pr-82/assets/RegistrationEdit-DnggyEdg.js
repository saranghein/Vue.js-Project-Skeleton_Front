import{_ as I,r as t,u as L,a as P,w as H,c as K,o as W,b as q,d as o,e as n,R as A,f as J,g as Q,h as X,i as Z,j as ee,k as le,l as ae,B as E,M as oe,F as te,A as se,m as ne,n as ue,p as re}from"./index-BT5Qe8jn.js";const ie={class:"row mt-5"},de={class:"col-10-md-6 mb-5"},ve={class:"d-flex justify-content-center gap-2 flex-wrap"},me={class:"col-auto"},ce={class:"col-auto"},fe={class:"row mb-2 mt-3"},pe={class:"col-10-md-6 mx-auto"},ye={class:"row mb-4"},ge={class:"col-10-md-6 mx-auto"},Ve={__name:"RegistrationEdit",props:{isModal:Boolean},emits:["close"],setup(U,{emit:G}){const r=t(""),i=t(""),c=t(""),d=t(""),v=t(""),w=t(""),N=t(""),V=L(),u=t("income"),m=t(null),f=t(null),b=t(!1),S=G,y=t(!1),x=t(""),C=t(!1),p=(a,e=!1)=>{x.value=a,C.value=e,y.value=!0},T=()=>{y.value=!1,j.isModal?S("close"):C.value?M.push("/transaction-history"):M.push("/")},h=()=>{y.value=!1},j=U,D=P(),M=ne(),_=D.params.id,R=a=>{u.value=a};H(u,()=>{if(!b.value){b.value=!0;return}m.value=null,f.value=null});const F=K(()=>u.value==="income"?"수입의 출처를 입력하세요":u.value==="expense"?"사용처를 입력하세요":""),s=t({date:!1,time:!1,amount:!1,category:!1,depositor:!1}),O=async()=>{var $,k;const a={date:!r.value,time:!i.value,amount:!v.value,category:!m.value||!m.value.name,depositor:!d.value};if(s.value=a,!!Object.values(a).some(Boolean))return;const l={user_id:"test_user",date:r.value,time:i.value,amount:Number(v.value),category:($=m.value)==null?void 0:$.name,source:d.value,paymentMethod:((k=f.value)==null?void 0:k.name)||"",memo:c.value,flow_type:u.value==="income"?"수입":"지출"};try{let g;g=await re.update(_,l),g.status>=200&&g.status<300?p("수정 완료!",!0):p("수정 실패!",!0)}catch{p("요청 중 문제가 발생했습니다.",!0)}finally{z()}},B=()=>{p("수정한 내용이 사라집니다.",!0)},Y=async()=>{try{const{data:a}=await se.get("money",_);if(!a)throw new Error("존재하지 않는 거래입니다.");r.value=a.date,i.value=a.time,v.value=a.amount,c.value=a.memo,d.value=a.source,u.value=a.flow_type==="수입"?"income":"expense",m.value=V.categories.find(e=>e.name===a.category),f.value=V.paymentMethods.find(e=>e.name===a.payment)}catch{p("존재하지 않는 거래입니다.",!0)}b.value=!1},z=()=>{r.value="",i.value="",v.value="",w.value="",d.value="",N.value="",c.value="",u.value="",s.value={date:!1,time:!1,amount:!1,category:!1,depositor:!1}};return W(()=>{V.fetchOptions(),Y()}),(a,e)=>(ue(),q(te,null,[o("div",{class:"row mt-4"},[o("div",{class:"col-10-md-6 mx-auto"},[o("div",{class:"row align-items-center"},[o("div",{class:"col-auto pointer",onClick:B},e[14]||(e[14]=[o("i",{class:"fa-solid fa-chevron-left"},null,-1)])),e[15]||(e[15]=o("div",{class:"col text-center"},[o("span",{class:"registry-title"}," 거래 등록 ")],-1)),e[16]||(e[16]=o("div",{class:"col-auto pointer",style:{visibility:"hidden"}},[o("i",{class:"fa-solid fa-chevron-left"})],-1))])])]),o("div",ie,[o("div",de,[o("div",ve,[o("div",me,[n(A,{bgColor:"GRAY01",label:"수입","is-active":u.value==="income",onClick:e[0]||(e[0]=l=>R("income"))},null,8,["is-active"])]),o("div",ce,[n(A,{bgColor:"GRAY01",label:"지출","is-active":u.value==="expense",onClick:e[1]||(e[1]=l=>R("expense"))},null,8,["is-active"])])])]),n(J,{modelValue:r.value,"onUpdate:modelValue":[e[2]||(e[2]=l=>r.value=l),e[3]||(e[3]=l=>{r.value=l,l&&(s.value.date=!1)})],error:s.value.date},null,8,["modelValue","error"]),n(Q,{modelValue:i.value,"onUpdate:modelValue":[e[4]||(e[4]=l=>i.value=l),e[5]||(e[5]=l=>{i.value=l,l&&(s.value.time=!1)})],error:s.value.time},null,8,["modelValue","error"]),n(X,{modelValue:v.value,"onUpdate:modelValue":[e[6]||(e[6]=l=>v.value=l),e[7]||(e[7]=l=>{v.value=l,l&&(s.value.amount=!1)})],error:s.value.amount},null,8,["modelValue","error"]),n(Z,{modelValue:m.value,"onUpdate:modelValue":[e[8]||(e[8]=l=>m.value=l),e[9]||(e[9]=l=>{w.value=l,l&&(s.value.category=!1)})],"selected-type":u.value,error:s.value.category},null,8,["modelValue","selected-type","error"]),n(ee,{modelValue:d.value,"onUpdate:modelValue":[e[10]||(e[10]=l=>d.value=l),e[11]||(e[11]=l=>{d.value=l,l&&(s.value.depositor=!1)})],error:s.value.depositor,placeholder:F.value},null,8,["modelValue","error","placeholder"]),n(le,{modelValue:f.value,"onUpdate:modelValue":e[12]||(e[12]=l=>f.value=l),"selected-type":u.value},null,8,["modelValue","selected-type"]),n(ae,{modelValue:c.value,"onUpdate:modelValue":e[13]||(e[13]=l=>c.value=l)},null,8,["modelValue"]),o("div",fe,[o("div",pe,[n(E,{type:"button",name:"수정",bgColor:"GREEN02",color:"BLACK","click-handler":O,style:{"font-size":"20px"}})])]),o("div",ye,[o("div",ge,[n(E,{type:"button",name:"취소",color:"WHITE",bgColor:"GRAY01","click-handler":B,style:{"font-size":"20px"}})])])]),n(oe,{visible:y.value,message:x.value,onConfirm:T,onCancel:h},null,8,["visible","message"])],64))}},we=I(Ve,[["__scopeId","data-v-92a81dde"]]);export{we as default};
